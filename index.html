<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AmeoTG.VN Nhân Sự TG.Ameo</title>
<style>
body { font-family: Arial, sans-serif; background:#f0f2f5; margin:0; padding:0; }
header { background:linear-gradient(90deg, red, orange, yellow, green, blue, indigo, violet);
color:white; padding:20px; text-align:center; font-size:28px; font-weight:bold;
background-size:400% 400%; animation:ledTextAnimation 5s linear infinite;}
@keyframes ledTextAnimation { 0% {background-position:0% 50%;} 50% {background-position:100% 50%;} 100% {background-position:0% 50%;} }
.container { padding:20px; max-width:1000px; margin:auto; opacity:0; transition: opacity 0.5s ease-in-out; height:0; overflow:hidden; }
.container.show { opacity:1; height:auto; }
.section-title { text-align:center; font-size:20px; margin:10px 0; font-weight:bold; color:#333; }
.highlight { color:red; }
.employee-list { display:flex; flex-wrap:wrap; justify-content:center; gap:20px; margin-bottom:40px; }
.employee { background:white; border-radius:15px; padding:15px; width:180px; text-align:center; box-shadow:0 2px 5px rgba(0,0,0,0.1);}
.avatar-frame { width:110px; height:110px; border-radius:50%; padding:5px; margin:auto; display:flex; align-items:center; justify-content:center; animation:ledAnimation 3s linear infinite; }
.employee img { width:100px; height:100px; border-radius:50%; object-fit:cover; cursor:pointer; transition:0.3s;}
.employee img:hover, .employee img:active { transform: scale(1.05); }
@keyframes ledAnimation { 0% {box-shadow:0 0 10px red,0 0 20px orange,0 0 30px yellow,0 0 40px green,0 0 50px blue,0 0 60px indigo,0 0 70px violet;} 
14% {box-shadow:0 0 10px orange,0 0 20px yellow,0 0 30px green,0 0 40px blue,0 0 50px indigo,0 0 60px violet,0 0 70px red;} 
28% {box-shadow:0 0 10px yellow,0 0 20px green,0 0 30px blue,0 0 40px indigo,0 0 50px violet,0 0 60px red,0 0 70px orange;} 
42% {box-shadow:0 0 10px green,0 0 20px blue,0 0 30px indigo,0 0 40px violet,0 0 50px red,0 0 60px orange,0 0 70px yellow;} 
57% {box-shadow:0 0 10px blue,0 0 20px indigo,0 0 30px violet,0 0 40px red,0 0 50px orange,0 0 60px yellow,0 0 70px green;} 
71% {box-shadow:0 0 10px indigo,0 0 20px violet,0 0 30px red,0 0 40px orange,0 0 50px yellow,0 0 60px green,0 0 70px blue;} 
85% {box-shadow:0 0 10px violet,0 0 20px red,0 0 30px orange,0 0 40px yellow,0 0 50px green,0 0 60px blue,0 0 70px indigo;} 
100% {box-shadow:0 0 10px red,0 0 20px orange,0 0 30px yellow,0 0 40px green,0 0 50px blue,0 0 60px indigo,0 0 70px violet;} }
.admin-info { background:linear-gradient(135deg,#f9f871,#f87171); border-radius:15px; padding:8px; margin-top:10px; text-align:left; font-size:12px; box-shadow:0 0 8px rgba(0,0,0,0.2); position:relative;}
.admin-info::after { content:''; width:20px; height:20px; border:2px solid #f87171; border-radius:50%; position:absolute; top:-10px; right:-10px; transform:rotate(45deg); box-shadow:0 0 8px rgba(248,113,113,0.6);}
.staff-info { background:#cce5ff; border-radius:10px; padding:5px; margin-top:8px; text-align:left; font-size:12px; box-shadow:0 0 5px rgba(0,0,0,0.1);}
.employee button { margin-top:5px; padding:4px 8px; border:none; border-radius:5px; background:#007bff; color:white; cursor:pointer; font-size:12px;}
.employee button:hover { background:#0056b3; }
.add-form, .search-bar, .company-edit { text-align:center; margin:10px; }
.add-form input, .company-edit input, .search-bar input, #loginForm input, #changePasswordForm input, #forgotPasswordForm input { padding:5px; margin:3px; border-radius:5px; border:1px solid #ccc;}
.add-form button, .company-edit button, #loginForm button, #changePasswordForm button, #forgotPasswordForm button { padding:5px 10px; border:none; border-radius:5px; background:green; color:white; cursor:pointer; margin-top:5px;}
.add-form button:hover, .company-edit button:hover, #loginForm button:hover, #changePasswordForm button:hover, #forgotPasswordForm button:hover { background:darkgreen;}
#loginContainer {text-align:center; margin-top:100px;}
#loginForm { display:inline-block; background:white; padding:20px; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.2);}
#changePasswordForm { display:none; margin:10px auto; max-width:300px; background:white; padding:15px; border-radius:10px; box-shadow:0 0 8px rgba(0,0,0,0.2);}
#forgotPasswordForm { display:none; text-align:center; margin-top:10px; background:white; padding:15px; border-radius:10px; box-shadow:0 0 10px rgba(0,0,0,0.2); max-width:300px; margin:auto; }
#rulesSection { text-align:left; max-width:600px; margin:auto; margin-bottom:20px;}
#rulesSection ul { list-style-type:decimal; padding-left:20px; }
#rulesSection button { padding:5px 10px; border:none; border-radius:5px; background:#ff9800; color:white; cursor:pointer; margin-top:5px;}
#editRulesForm textarea { width:100%; border-radius:5px; border:1px solid #ccc; padding:5px; max-height:150px; overflow-y:auto; }
@media(max-width:500px){
  .employee { width:140px; padding:10px; }
  .avatar-frame { width:80px; height:80px; }
  header { font-size:22px; padding:15px; }
  .employee-list { flex-direction: column; align-items:center; }
}
</style>
</head>
<body>
<header>AmeoTG.VN Nhân Sự TG.Ameo</header>

<div id="loginContainer">
  <form id="loginForm">
    <h2>Đăng nhập</h2>
    <label><input type="radio" name="role" value="admin" checked> Admin</label>
    <label><input type="radio" name="role" value="staff"> Nhân viên</label><br>
    <input type="text" id="loginUser" placeholder="Tên đăng nhập"><br>
    <input type="password" id="loginPass" placeholder="Mật khẩu"><br>
    <button type="button" onclick="login()">Đăng nhập</button>
  </form>
  <div style="margin-top:10px;">
    <button type="button" onclick="showForgotPassword()" style="background:orange;">Quên mật khẩu?</button>
  </div>

  <div id="forgotPasswordForm">
    <h3>Quên mật khẩu</h3>
    <input type="text" id="fpUser" placeholder="Tên đăng nhập"><br>
    <input type="text" id="fpPhone" placeholder="Số điện thoại"><br>
    <button type="button" onclick="sendResetCode()">Nhận mã</button>
    <div id="fpMessage" style="margin-top:5px;color:green;"></div>
  </div>
</div>

<div class="container">
  <button onclick="logout()" style="float:right;background:red;">Đăng xuất</button>
  <button onclick="showChangePassword()" class="admin-only" style="float:right;margin-right:10px;">Đổi mật khẩu</button>

  <form id="changePasswordForm">
    <h3>Đổi mật khẩu</h3>
    <input type="password" id="currentPass" placeholder="Mật khẩu cũ"><br>
    <input type="password" id="newPass" placeholder="Mật khẩu mới"><br>
    <button type="button" onclick="changePassword()">Lưu mật khẩu</button>
  </form>

  <div class="company-edit admin-only" id="companyEditSection">
    <input type="text" id="companyNameInput" placeholder="Tên công ty" value="AmeoTG.VN">
    <input type="text" id="companyIntroInput" placeholder="Giới thiệu công ty" value="Uy tín, Trung thực ♥️">
    <input type="text" id="companyPhoneInput" placeholder="SĐT công ty" value="0123456789">
    <input type="text" id="companyAddressInput" placeholder="Địa chỉ công ty" value="123 Đường ABC, Quận XYZ, TP. HCM">
    <button onclick="saveCompanyInfo()">Lưu thay đổi</button>
  </div>

  <div class="section-title">Nội Quy Công Ty</div>
  <div id="rulesSection">
    <ul id="rulesList"></ul>
    <button id="editRulesBtn" class="admin-only" onclick="editRules()">Sửa nội quy</button>
    <div id="editRulesForm" class="admin-only" style="display:none; text-align:center; margin-top:10px;">
      <textarea id="editRulesTextarea" rows="5" placeholder="Nhập nội quy, mỗi nội quy 1 dòng"></textarea><br>
      <button onclick="saveRules()">Lưu nội quy</button>
      <button onclick="cancelEditRules()">Hủy</button>
    </div>
  </div>

  <div class="section-title">Admin</div>
  <div class="employee-list" id="adminList"></div>

  <div class="check-fraud">Check gian lận nhân viên</div>

  <div class="search-bar">
    <input type="text" id="searchInput" placeholder="Tìm nhân viên theo tên, chức vụ, vi phạm nội quy..." oninput="filterStaff()">
  </div>

  <div class="section-title">Tiền cọc</div>
  <div class="employee-list" id="staffList"></div>

  <div class="add-form admin-only">
    <input type="text" id="name" placeholder="Tên nhân viên/Admin">
    <input type="text" id="position" placeholder="Chức vụ">
    <input type="text" id="avatar" placeholder="Link avatar">
    <button onclick="addEmployee()">Thêm</button>
  </div>

  <div class="company-info-led">
    <div><strong>Tên công ty:</strong> AmeoTG.VN</div>
    <div><strong>Điện thoại:</strong> 0123456789</div>
    <div><strong>Địa chỉ:</strong> 123 Đường ABC, Quận XYZ, TP. HCM</div>
  </div>
</div>

<script>
// ======= Tài khoản =======
let adminUser = "Admin", adminPass = "Admin123";
let staffUser = "Ameotg", staffPass = "123456";
let loggedInRole = null;
let isAdmin = false;

// ======= Dữ liệu =======
let admins = [
  {name:"Admin1", avatar:"https://i.pravatar.cc/100?img=1", info:["Giám đốc","Uy tín","Trung thực"]},
  {name:"Admin2", avatar:"https://i.pravatar.cc/100?img=2", info:["Quản lý","Chuyên nghiệp","Tận tâm"]}
];
let staff = [];
for(let i=1;i<=50;i++){ staff.push({name:"NV"+i, avatar:"https://i.pravatar.cc/100?img="+(i+2), deposit:0, info:["Info2","Info3"]}); }
let rules=["Đi làm đúng giờ","Không gian lận","Giữ vệ sinh"];

// ======= Đăng nhập / Logout / Hiển thị =======
function login(){
  const role = document.querySelector('input[name="role"]:checked').value;
  const user = document.getElementById('loginUser').value.trim();
  const pass = document.getElementById('loginPass').value;
  if(role==="admin" && user===adminUser && pass===adminPass){ loggedInRole="admin"; isAdmin=true; showDashboard(); }
  else if(role==="staff" && user===staffUser && pass===staffPass){ loggedInRole="staff"; isAdmin=false; showDashboard(); }
  else { alert('Sai tên hoặc mật khẩu!'); }
}

function showDashboard(){
  document.getElementById('loginContainer').style.display='none';
  const container = document.querySelector('.container');
  container.classList.add('show');
  
  document.querySelectorAll('.admin-only').forEach(el=>el.style.display=isAdmin?"block":"none");
  renderEmployees(); 
  renderRules();
}

// ======= Logout / đổi mật khẩu =======
function logout(){ loggedInRole=null; isAdmin=false; document.getElementById('loginContainer').style.display='block'; document.querySelector('.container').style.display='none'; document.getElementById('loginUser').value=''; document.getElementById('loginPass').value=''; }
function showChangePassword(){ document.getElementById('changePasswordForm').style.display='block'; }
function changePassword(){ const current=document.getElementById('currentPass').value; const nw=document.getElementById('newPass').value; if(loggedInRole==="admin"){ if(current===adminPass && nw){ adminPass=nw; alert('Đổi mật khẩu Admin thành công!'); } else{ alert('Sai mật khẩu hiện tại hoặc mật khẩu mới trống!'); } } else if(loggedInRole==="staff"){ if(current===staffPass && nw){ staffPass=nw; alert('Đổi mật khẩu Nhân viên thành công!'); } else{ alert('Sai mật khẩu hiện tại hoặc mật khẩu mới trống!'); } } document.getElementById('currentPass').value=''; document.getElementById('newPass').value=''; document.getElementById('changePasswordForm').style.display='none'; }

// ======= Render nhân viên =======
function renderEmployees(){
  const adminList=document.getElementById('adminList'); adminList.innerHTML='';
  admins.forEach((a,i)=>{ adminList.innerHTML+=`
  <div class="employee">
    <div class="avatar-frame"><img src="${a.avatar}" alt="${a.name}" onclick="isAdmin && document.getElementById('adminAvatarInput${i}').click()"></div>
    <input type="file" id="adminAvatarInput${i}" style="display:none" accept="image/*" onchange="changeAvatar(event,${i},'admin')">
    <h3>${a.name}</h3>
    <div class="admin-info">${a.info.join("<br>")}</div>
    ${isAdmin?`<button onclick="editEmployee(${i},'admin')">Sửa Admin</button>`:""}
  </div>`; });

  const staffList=document.getElementById('staffList'); staffList.innerHTML='';
  staff.forEach((s,i)=>{
    let violation=s.info.some((v,j)=>v.toLowerCase().includes("vi phạm"))?"highlight":"";
    staffList.innerHTML+=`
    <div class="employee" id="staffDiv${i}">
      <div class="avatar-frame"><img src="${s.avatar}" alt="${s.name}" ${isAdmin ? `onclick="document.getElementById('staffAvatarInput${i}').click()"` : ""}></div>
      <input type="file" id="staffAvatarInput${i}" style="display:none" accept="image/*" onchange="changeAvatar(event,${i},'staff')">
      <h3>${s.name}</h3>
      <div class="staff-info ${violation}">Tiền cọc: ${s.deposit}<br>${s.info.join("<br>")}</div>
      ${isAdmin?`<button onclick="editEmployee(${i},'staff')">Sửa NV</button>`:""}
      <button onclick="shareStaffLink(${i})">Chia sẻ link</button>
    </div>`;
  });
}

function changeAvatar(event,index,type){
  if(!isAdmin) return;
  const file = event.target.files[0];
  if(file){
    if(file.size>2*1024*1024){ alert("Ảnh quá lớn (>2MB)!"); return; }
    const reader = new FileReader();
    reader.onload = function(e){
      if(type==='admin'){ admins[index].avatar = e.target.result; }
      else { staff[index].avatar = e.target.result; }
      renderEmployees();
    };
    reader.readAsDataURL(file);
  }
}

// ======= Share link =======
function shareStaffLink(index){
  const staffMember = staff[index];
  const link = `${window.location.origin}${window.location.pathname}?staff=${encodeURIComponent(staffMember.name)}`;
  navigator.clipboard.writeText(link).then(()=>{ alert(`Link của ${staffMember.name} đã được sao chép:\n${link}`); });
}

// ======= Nội quy =======
function renderRules(){ const ul=document.getElementById('rulesList'); ul.innerHTML=''; rules.forEach(r=>{ ul.innerHTML+='<li>'+r+'</li>'; }); }
function editRules(){ if(!isAdmin) return; document.getElementById('editRulesForm').style.display='block'; document.getElementById('editRulesTextarea').value = rules.join('\n'); }
function saveRules(){ if(!isAdmin) return; let newRules = document.getElementById('editRulesTextarea').value.trim(); if(newRules){ rules = newRules.split(/\n+/); renderRules(); } cancelEditRules(); }
function cancelEditRules(){ document.getElementById('editRulesForm').style.display='none'; }

// ======= Thêm/Sửa nhân viên =======
function editEmployee(index,type){ if(!isAdmin) return; let emp=(type==='admin'?admins:staff)[index]; let divs=(type==='admin'?document.getElementById('adminList').children:document.getElementById('staffList').children); let div=divs[index]; let infoInputs=emp.info.map((line,i)=>`<input type="text" value="${line}" id="editInfo${type}${index}${i}">`).join(''); div.innerHTML=`<div class="avatar-frame"><img src="${emp.avatar}"></div><input type="text" value="${emp.name}" id="editName${type}${index}"><br>${infoInputs}<br><button onclick="saveEdit(${index},'${type}')">Lưu</button>`; }
function saveEdit(index,type){ let emp=(type==='admin'?admins:staff)[index]; let newName=document.getElementById(`editName${type}${index}`).value.trim(); if(newName) emp.name=newName; for(let i=0;i<emp.info.length;i++){ let newInfo=document.getElementById(`editInfo${type}${index}${i}`).value.trim(); if(newInfo) emp.info[i]=newInfo; } renderEmployees(); renderRules(); }
function filterStaff(){ let term=document.getElementById('searchInput').value.toLowerCase(); staff.forEach((s,i)=>{ let div=document.getElementById('staffList').children[i]; div.style.display=s.name.toLowerCase().includes(term) || s.info.join(' ').toLowerCase().includes(term)?"block":"none"; }); }
function saveCompanyInfo(){ alert('Cập nhật công ty thành công!'); }
function addEmployee(){ if(!isAdmin) return; let name=document.getElementById('name').value, avatar=document.getElementById('avatar').value; if(!name) return alert('Nhập tên!'); staff.push({name:name,avatar:avatar||"https://i.pravatar.cc/100?img=50",deposit:0,info:["Info2","Info3"]}); renderEmployees(); }

// ======= Quên mật khẩu =======
let resetCode = "";
function showForgotPassword(){ document.getElementById('forgotPasswordForm').style.display='block'; }
function sendResetCode(){
  const user = document.getElementById('fpUser').value.trim();
  const phone = document.getElementById('fpPhone').value.trim();
  if(!user || !phone){ alert("Nhập đầy đủ thông tin!"); return; }
  let valid = false;
  if(user === adminUser && phone==="0123456789") valid = "admin";
  else if(user === staffUser && phone==="0123456789") valid = "staff";
  if(!valid){ alert("Tên đăng nhập hoặc số điện thoại không đúng!"); return; }
  resetCode = Math.floor(100000 + Math.random() * 900000);
  document.getElementById('fpMessage').innerText = `Mã xác nhận đã gửi đến số ${phone}: ${resetCode} (Mô phỏng)`;
  if(!document.getElementById('resetCodeInput')){
    const div = document.getElementById('forgotPasswordForm');
    div.innerHTML += `<br><input type="text" id="resetCodeInput" placeholder="Nhập mã xác nhận"><br>
      <input type="password" id="newPassFP" placeholder="Mật khẩu mới"><br>
      <button onclick="confirmResetCode('${valid}')">Đặt lại mật khẩu</button>`;
  }
}
function confirmResetCode(role){
  const code = document.getElementById('resetCodeInput').value.trim();
  const newPass = document.getElementById('newPassFP').value.trim();
  if(code != resetCode){ alert("Mã xác nhận không đúng!"); return; }
  if(!newPass){ alert("Nhập mật khẩu mới!"); return; }
  if(role==="admin") adminPass = newPass;
  else staffPass = newPass;
  alert("Đặt lại mật khẩu thành công!");
  document.getElementById('forgotPasswordForm').style.display='none';
  resetCode = "";
}
</script>
</body>
</html>
